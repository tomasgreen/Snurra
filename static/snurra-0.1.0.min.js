(function(){"use strict";function t(t){(void 0===t||null===t)&&(t={});var e={};for(var n in g)e[n]=void 0!==t[n]?t[n]:g[n];return e}function e(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild}function n(t,e){a(t,function(t){t.removeAttribute(e)})}function i(t){return parseInt(t,10)}function a(t,e){!t||0===t.length&&t!=window||(t.length?Array.prototype.forEach.call(t,function(t,n){e(t)}):e(t))}function o(t,e,n,i){r(t,e,function(a){s(t,e,n,i),n(a)},i)}function r(t,e,n,i){a(t,function(t){var a=e.split(" ");for(var o in a)t.addEventListener(a[o],n,i)})}function s(t,e,n,i){a(t,function(t){var a=e.split(" ");for(var o in a)t.removeEventListener(a[o],n,i)})}function p(t){"function"==typeof t.stopPropagation?(t.stopPropagation(),t.preventDefault()):window.event&&window.event.hasOwnProperty("cancelBubble")&&(window.event.cancelBubble=!0)}function u(t,e){if(void 0===t.ontouchstart)return void r(t,"click",e);var n=!1;r(t,"touchstart",function(t){n=!0}),r(t,"touchend",function(t){n&&(e(t),p(t))}),r(t,"touchcancel touchleave touchmove",function(t){n=!1})}function h(t,e){s(t,"touchstart touchend touchcancel click",e)}function c(t,e){a(t,function(t){if(t.classList){var n=e.split(" ");for(var i in n)t.classList.add(n[i])}else t.className+=" "+e})}function f(t,e){a(t,function(t){if(t.classList){var n=e.split(" ");for(var i in n)t.classList.remove(n[i])}else t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")})}function d(t,e,n){return void 0===n&&t&&void 0!==t.getAttribute?t.getAttribute(e):void a(t,function(t){t.setAttribute(e,n)})}function l(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(t){4==n.readyState&&200==n.status&&e(n.responseText)},n.open("GET",t),n.overrideMimeType("text/plain"),n.send()}function m(t){return"string"==typeof t}var v="webkitAnimationEnd mozAnimationEnd msAnimationEnd oAnimationEnd animationend",y='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32"><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(0 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(22.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.0625s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(45 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.125s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(67.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.1875s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(90 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.25s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(112.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.3125s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(135 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.375s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(157.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.4375s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(180 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.5s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(202.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.5625s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(225 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.625s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(247.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.6875s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(270 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.75s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(292.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.8125s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(315 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.875s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(337.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.9375s"/></path></svg>',b={"default":y},g={autoStart:!0,maxSize:24,autoStartOnTap:null,onTap:null,spinner:"default"},H=function(e,n){m(e)&&(e=document.querySelector(e)),e&&(this.opt=t(n),this.el=e,this.opt.onTap&&(this.opt.autoStart=!1,this.tapOn(this.opt.onTap)),this.eventListeners=[],this.opt.autoStart&&this.start())};H.prototype.start=function(){if(!d(this.el,"data-spinning")){c(this.el,"snurra"),this.textEl=document.createElement("div"),this.textEl.innerHTML=this.el.innerHTML,this.spinnerEl=e(b[this.opt.spinner]?b[this.opt.spinner]:b["default"]),c(this.textEl,"snurra-text"),c(this.spinnerEl,"snurra-img"),this.el.innerHTML="",this.el.appendChild(this.textEl),this.el.appendChild(this.spinnerEl);var t=this.el.clientHeight-6;t>this.opt.maxSize&&(t=this.opt.maxSize),d(this.el,"data-spinning",!0),d(this.spinnerEl,"height",t),d(this.spinnerEl,"width",t),this.spinnerEl.style.marginLeft="-"+i(t/2)+"px",this.spinnerEl.style.marginTop="-"+i(t/2)+"px",d(this.el,"disabled","true"),c(this.textEl,"snurra-text-fadeout"),c(this.spinnerEl,"snurra-img-fadein")}},H.prototype.stop=function(t){d(this.el,"data-spinning")&&(n(this.el,"disabled"),n(this.el,"data-spinning"),f(this.textEl,"snurra-text-fadeout"),f(this.spinnerEl,"snurra-img-fadein"),c(this.textEl,"snurra-text-fadein"),c(this.spinnerEl,"snurra-img-fadeout"),o(this.textEl,v,function(e){this.el.innerHTML=this.textEl.innerHTML,f(this.el,"snurra"),t&&t(this)}.bind(this)))},H.prototype.destroy=function(t){this.stop(t);for(var e in this.eventListeners){var n=this.eventListeners[e];this.off(n.e,n.c,n.u)}this.onTapEvent&&this.tapOff()},H.prototype.pushEvent=function(t,e,n){this.eventListeners.push({e:t,c:e,u:n})},H.prototype.on=function(t,e,n){this.pushEvent.push(t,e,n),r(this.el,t,e,n)},H.prototype.one=function(t,e,n){this.pushEvent.push(t,e,n),o(this.el,t,e,n)},H.prototype.onTap=function(t){this.opt.onTap=t,this.onTapEvent&&this.tapOff(),this.opt.autoStartOnTap!==!1&&(this.opt.autoStartOnTap=!0),this.onTapEvent=function(t){this.opt.autoStartOnTap&&this.start(),this.opt.onTap(t)},u(this.el,this.onTapEvent.bind(this))},H.prototype.tapOff=function(){h(this.el,this.onTapEvent)},H.prototype.off=function(t,e,n){s(this.el,t,e,n)};var E=this;E.Snurra=function(t,e){var n=new H(t,e);return n},E.Snurra.globals=g,E.Snurra.addSpinner=function(t,e){b[t]||l(t,function(n){n?(b[t]=n,e&&(E.Snurra.globals.spinner=t)):console.log('could not download spinner "'+t+'"')})}}).call(this);