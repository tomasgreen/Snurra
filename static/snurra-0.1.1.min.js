(function(){"use strict";function t(e,i){e.firstChild&&(i.appendChild(e.firstChild),t(e,i))}function e(t){(void 0===t||null===t)&&(t={});var e={};for(var i in E)e[i]=void 0!==t[i]?t[i]:E[i];return e}function i(t){var e=document.createElement("div");return e.innerHTML=t,e.firstChild}function n(t,e){o(t,function(t){t.removeAttribute(e)})}function a(t){return parseInt(t,10)}function o(t,e){!t||0===t.length&&t!=window||(t.length?Array.prototype.forEach.call(t,function(t,i){e(t)}):e(t))}function r(t,e,i,n){s(t,e,function(a){p(t,e,i,n),i(a)},n)}function s(t,e,i,n){o(t,function(t){var a=e.split(" ");for(var o in a)t.addEventListener(a[o],i,n)})}function p(t,e,i,n){o(t,function(t){var a=e.split(" ");for(var o in a)t.removeEventListener(a[o],i,n)})}function u(t){"function"==typeof t.stopPropagation?(t.stopPropagation(),t.preventDefault()):window.event&&window.event.hasOwnProperty("cancelBubble")&&(window.event.cancelBubble=!0)}function h(t,e){if(void 0===t.ontouchstart)return void s(t,"click",e);var i=!1;s(t,"touchstart",function(t){i=!0}),s(t,"touchend",function(t){i&&(e(t),u(t))}),s(t,"touchcancel touchleave touchmove",function(t){i=!1})}function c(t,e){p(t,"touchstart touchend touchcancel click",e)}function f(t,e){o(t,function(t){if(t.classList){var i=e.split(" ");for(var n in i)t.classList.add(i[n])}else t.className+=" "+e})}function d(t,e){o(t,function(t){if(t.classList){var i=e.split(" ");for(var n in i)t.classList.remove(i[n])}else t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")})}function l(t,e,i){return void 0===i&&t&&void 0!==t.getAttribute?t.getAttribute(e):void o(t,function(t){t.setAttribute(e,i)})}function m(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(t){4==i.readyState&&200==i.status&&e(i.responseText)},i.open("GET",t),i.overrideMimeType("text/plain"),i.send()}function v(t){return"string"==typeof t}var y="webkitAnimationEnd mozAnimationEnd msAnimationEnd oAnimationEnd animationend",b='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32"><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(0 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(22.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.0625s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(45 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.125s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(67.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.1875s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(90 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.25s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(112.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.3125s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(135 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.375s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(157.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.4375s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(180 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.5s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(202.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.5625s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(225 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.625s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(247.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.6875s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(270 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.75s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(292.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.8125s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(315 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.875s"/></path><path opacity=".1" d="M15 0 H17 V8 H15 z" transform="rotate(337.5 16 16)"><animate restart="whenNotActive" attributeName="opacity" from="1" to=".1" dur="1s" repeatCount="indefinite" begin="0.9375s"/></path></svg>',g={"default":b},E={autoStart:!0,maxSize:24,autoStartOnTap:null,onTap:null,spinner:"default"},w=function(t,i){v(t)&&(t=document.querySelector(t)),t&&(this.opt=e(i),this.el=t,this.opt.onTap&&(this.opt.autoStart=!1,this.tapOn(this.opt.onTap)),this.eventListeners=[],this.opt.autoStart&&this.start())};w.prototype.start=function(){if(!l(this.el,"data-spinning")){f(this.el,"snurra"),this.textEl=document.createElement("div"),t(this.el,this.textEl),this.spinnerEl=i(g[this.opt.spinner]?g[this.opt.spinner]:g["default"]),f(this.textEl,"snurra-text"),f(this.spinnerEl,"snurra-img"),this.el.appendChild(this.textEl),this.el.appendChild(this.spinnerEl);var e=this.el.clientHeight-6;e>this.opt.maxSize&&(e=this.opt.maxSize),l(this.el,"data-spinning",!0),l(this.spinnerEl,"height",e),l(this.spinnerEl,"width",e),this.spinnerEl.style.marginLeft="-"+a(e/2)+"px",this.spinnerEl.style.marginTop="-"+a(e/2)+"px",l(this.el,"disabled","true"),f(this.textEl,"snurra-text-fadeout"),f(this.spinnerEl,"snurra-img-fadein")}},w.prototype.stop=function(e){l(this.el,"data-spinning")&&(n(this.el,"disabled"),n(this.el,"data-spinning"),d(this.textEl,"snurra-text-fadeout"),d(this.spinnerEl,"snurra-img-fadein"),f(this.textEl,"snurra-text-fadein"),f(this.spinnerEl,"snurra-img-fadeout"),r(this.textEl,y,function(i){t(this.textEl,this.el),this.el.removeChild(this.textEl),this.el.removeChild(this.spinnerEl),d(this.el,"snurra"),e&&e(this)}.bind(this)))},w.prototype.destroy=function(t){this.stop(t);for(var e in this.eventListeners){var i=this.eventListeners[e];this.off(i.e,i.c,i.u)}this.onTapEvent&&this.tapOff()},w.prototype.pushEvent=function(t,e,i){this.eventListeners.push({e:t,c:e,u:i})},w.prototype.on=function(t,e,i){this.pushEvent.push(t,e,i),s(this.el,t,e,i)},w.prototype.one=function(t,e,i){this.pushEvent.push(t,e,i),r(this.el,t,e,i)},w.prototype.onTap=function(t){this.opt.onTap=t,this.onTapEvent&&this.tapOff(),this.opt.autoStartOnTap!==!1&&(this.opt.autoStartOnTap=!0),this.onTapEvent=function(t){this.opt.autoStartOnTap&&this.start(),this.opt.onTap(t)},h(this.el,this.onTapEvent.bind(this))},w.prototype.tapOff=function(){c(this.el,this.onTapEvent)},w.prototype.off=function(t,e,i){p(this.el,t,e,i)};var H=this;H.Snurra=function(t,e){var i=new w(t,e);return i},H.Snurra.globals=E,H.Snurra.addSpinner=function(t,e){g[t]||m(t,function(i){i?(g[t]=i,e&&(H.Snurra.globals.spinner=t)):console.log('could not download spinner "'+t+'"')})}}).call(this);